<title>Login</title>
<style>
  body {
    font-family: "Didact Gothic", sans-serif;
    background-image: url({{backgroundImage}});
  }

  .btn-custom-green {
    background-color: #2cbd4e;
    border-color: #28a745;
  }

  .btn-custom-green:hover {
    background-color: #389b4f;
  }

  .error {
    color: white;
    background: red;
    border: 1px solid black;
    display: none;
  }
</style>
</head>

<body>
  <div class="container d-flex align-items-center justify-content-center vh-100">
    <div class="card shadow-lg d-flex flex-column justify-content-between" style="width: 35rem; height: auto">
      <div class="text-center mt-4">
        <img src="{{logoImage}}" alt="Imagem de Login" class="img-fluid" style="max-height: 150px" />
      </div>
      <div class="card-body d-flex flex-column justify-content-end">
        <h3 class="card-title text-center mb-4">Login</h3>
        <form id="loginForm" action="/login" method="POST">
          <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" class="form-control bg-secondary-color" id="email" name="email"
              onchange="validateFields()" placeholder="Insira seu E-mail ou CPF" required />
            <div class="error">E-mail é obrigatório</div>
            <div class="error">E-mail inválido</div>
          </div>

          <div class="form-group" style="margin-top: 10px">
            <label for="password">Senha:</label>
            <input type="password" class="form-control" id="password" name="password" onchange="validateFields()"
              placeholder="Insira sua senha" required />
            <div class="error">Senha é obrigatória</div>
            <div class="error">Senha inválida</div>
            <small id="passwordError" class="text-danger d-none">A senha deve conter ao menos um número e um caractere
              especial.</small>
          </div>
          <button type="submit" class="btn btn-custom-green text-white btn-block mt-3 rounded-pill"
            style="width: 10rem">Entrar</button>
        </form>
        <p class="mt-3 mb-0 text-center">
        <form id="forgotPasswordForm" action="/forgot_password" method="POST" style="display: inline;">
          <input type="hidden" name="email" id="forgotPasswordEmail">
          <a href="#" onclick="submitForgotPassword()">Esqueceu a senha?</a>
        </form>

        </p>
        <p class="mt-4 text-center">Não tem uma conta? <a href="/cadastro">Cadastre-se aqui!</a></p>
      </div>
    </div>
  </div>
  <script>
    function submitForgotPassword() {
      const email = document.getElementById('email').value; // Agora estamos capturando o valor do campo de e-mail correto.

      if (!email) {
        alert("Please enter your email address before requesting a password reset.");
        return;
      }

      // Preenche o campo oculto com o valor do email.
      document.getElementById('forgotPasswordEmail').value = email;

      // Envia o formulário
      document.getElementById('forgotPasswordForm').submit();
    }

  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const errorMessage = "{{errorMessage}}";
      if (errorMessage) {
        alert(errorMessage);
      }
    });
  </script>
</body>

</html>